import React from 'react';
import { PopupStack } from '@workday/canvas-kit-popup-stack';
export var usePopupStack = function (forwardRef, target) {
    var internalRef = React.useRef(null);
    var ref = (forwardRef || internalRef);
    var popupRef = React.useState(function () {
        var container = PopupStack.createContainer();
        ref.current = container;
        return container;
    })[0];
    React.useLayoutEffect(function () {
        if (popupRef !== ref.current) {
            throw Error("The 'ref' passed to usePopupStack should not be applied to a React element. This will cause a runtime error where the PopupStack and React compete for the element. Instead use ReactDOM.createPortal(<YourComponent />, ref.current)");
        }
        var targetEl = target
            ? 'current' in target
                ? target.current || undefined
                : target
            : undefined;
        PopupStack.add({ element: ref.current, owner: targetEl });
        var element = ref.current;
        return function () {
            PopupStack.remove(element);
        };
    }, [ref, target, popupRef]);
    return ref;
};
